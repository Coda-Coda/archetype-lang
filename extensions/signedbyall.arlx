archetype extension signedbyall (

  action[%signedbyall roles] aTransaction

) = {

  asset signer_<%aTransaction> = {
    signer    : address;
    hasSigned : bool = false;
  } initialized by roles

  action sign_<%aTransaction> = {
    effect {
      signed.update caller { hasSigned = true }
    }
  }

  action aTransaction = {
    require {
      requires;
      <%aTransaction>_cond : (signer_<%aTransaction>.select(hasSigned = true)).count() = signer_<%aTransaction>.count()
    }
  }

}

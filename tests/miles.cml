model miles

role owner

role[%transferable] validator

asset account identified by account = {
  owner   : owner;
  amount  : uint
}

transaction add (owner : owner) (val : uint) = {
   called by validator
   action
     account.update owner { amount += val } { amount = 0 }
}

transaction consume (owner : owner) (val : uint) = {
   called by validator
   condition (account.get owner).amount >= val

   specification
     (before.account.get owner).amount =
             (after.account.get owner).amount + val

   action
     (account.get owner).amount -= val
}

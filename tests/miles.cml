model miles

role owner

role[%transferable] validator

asset account identified by owner = {
  owner  : address;
  amount : uint
}

transaction add (owner : address) (value : uint) = {
   called by validator
   action
     account.update owner { amount += value } { amount = 0 }
}

transaction consume (owner : address) (value : uint) = {
   called by validator
   condition (account.get owner).amount >= value

   specification
     (before.account.get owner).amount =
             (after.account.get owner).amount + value

   action
     (account.get owner).amount -= value
}

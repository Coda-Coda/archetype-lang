archetype lang_map

entry exec () {
  effect {
    var my_map : map<string, int> = [ ("mystr0", 0) ;
                                      ("mystr1", 1) ;
                                      ("mystr2", 2) ;
                                      ("mystr3", 3) ];

    (* expr *)
    var new_map1 : map<string, int> = map_put(my_map, "mystr4", 4);
    var new_map2 : map<string, int> = map_remove(my_map, "mystr0");
    var new_map3 : option<int>      = my_map["0"];
    var new_map4 : int              = map_getopt(my_map, "mystr0");
    var map_c    : bool             = map_contains(my_map, "mystr0");
    var map_l    : int              = map_length(my_map);

    (* control *)
    var res : int = 0;
    for (k, v) in my_map do
      if (k <> "")
      then res += v;
    done;
    dorequire (res = 6)
  }
}
